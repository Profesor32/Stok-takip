<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giriş Yap - StokTakip</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/">StokTakip</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/"><i class="fas fa-home me-2"></i> Ana Sayfa</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/frontend/products.html"><i class="fas fa-boxes me-2"></i> Ürünler</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/frontend/about.html"><i class="fas fa-info-circle me-2"></i> Hakkımızda</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/frontend/services.html"><i class="fas fa-concierge-bell me-2"></i> Hizmetlerimiz</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/frontend/projects.html"><i class="fas fa-project-diagram me-2"></i> Projelerimiz</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/frontend/contact.html"><i class="fas fa-envelope me-2"></i> İletişim</a>
                    </li>
                </ul>
                <div class="d-flex align-items-center">
                    <a href="/frontend/cart.html" class="btn btn-outline-light me-2 position-relative">
                        <i class="fas fa-shopping-cart"></i>
                        <span id="cartCount" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                            0
                        </span>
                    </a>
                    <div class="dropdown">
                        <button class="btn btn-outline-light dropdown-toggle" type="button" id="userMenu" data-bs-toggle="dropdown">
                            <i class="fas fa-user"></i>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end" id="userDropdown">
                            <li><a class="dropdown-item" href="/frontend/login.html">Giriş Yap</a></li>
                            <li><a class="dropdown-item" href="/frontend/register.html">Kayıt Ol</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Login Section -->
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header text-center">
                        <h2>Giriş Yap</h2>
                    </div>
                    <div class="card-body">
                        <div id="loginMessage" class="alert d-none" role="alert"></div>
                        <form id="loginForm">
                            <div class="mb-3">
                                <label for="username" class="form-label">Kullanıcı Adı veya E-posta</label>
                                <input type="text" class="form-control" id="username" required>
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">Şifre</label>
                                <input type="password" class="form-control" id="password" required>
                            </div>
                            <button type="submit" class="btn btn-primary w-100">Giriş Yap</button>
                        </form>
                        <p class="text-center mt-3">Hesabın yok mu? <a href="/frontend/register.html">Kayıt Ol</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3"></div>

    <!-- Footer -->
    <footer class="bg-dark text-light py-4">
        <div class="container">
            <div class="row mb-3">
                 <div class="col-md-4">
                    <h5>Site Bağlantıları</h5>
                    <ul class="list-unstyled">
                        <li><a href="/" class="text-light">Ana Sayfa</a></li>
                        <li><a href="/frontend/products.html" class="text-light">Ürünler</a></li>
                        <li><a href="/frontend/about.html" class="text-light">Hakkımızda</a></li>
                        <li><a href="/frontend/services.html" class="text-light">Hizmetlerimiz</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5>Kurumsal Bağlantılar</h5>
                    <ul class="list-unstyled">
                         <li><a href="/frontend/projects.html" class="text-light">Projelerimiz</a></li>
                        <li><a href="/frontend/contact.html" class="text-light">İletişim</a></li>
                        <li><a href="/frontend/login.html" class="text-light">Giriş Yap</a></li>
                        <li><a href="/frontend/register.html" class="text-light">Kayıt Ol</a></li>
                    </ul>
                </div>
                 <div class="col-md-4">
                    <h5>İletişim</h5>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-envelope me-2"></i> info@stoktakip.com</li>
                        <li><i class="fas fa-phone me-2"></i> 0 (537) 674 71 69</li>
                        <li><i class="fas fa-map-marker-alt me-2"></i> İstanbul, Türkiye</li>
                    </ul>
                     <p class="mt-3 text-muted">Bizimle iletişime geçmekten çekinmeyin.</p>
                </div>
            </div>
             <div class="row">
                <div class="col-md-12">
                    <h5>StokTakip Hakkında</h5>
                    <p>StokTakip, işletmelerin envanterlerini etkili bir şekilde yönetmelerini sağlayan kapsamlı bir web platformudur. Ürün takibi, stok giriş-çıkışları, satış raporları, tedarikçi yönetimi ve barkod entegrasyonu gibi ileri düzey özelliklerle iş süreçlerinizi baştan sona optimize edin. Küçük işletmelerden büyük depolara kadar her ölçekteki işletmenin ihtiyaçlarına uygun çözümler sunarız. Stoklarınızı anlık olarak takip ederek maliyetleri düşürün, verimliliği artırın ve müşteri memnuniyetini en üst düzeye çıkarın.</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/script.js"></script>
    <script>
        document.getElementById('loginForm').addEventListener('submit', async (event) => {
            event.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const messageDiv = document.getElementById('loginMessage');

            messageDiv.classList.add('d-none');
            messageDiv.classList.remove('alert-danger', 'alert-success');
            messageDiv.textContent = '';

            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();

                if (data.success) {
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('user', JSON.stringify(data.user)); // Kullanıcı bilgilerini sakla
                    messageDiv.classList.remove('d-none');
                    messageDiv.classList.add('alert-success');
                    messageDiv.textContent = 'Giriş başarılı! Yönlendiriliyorsunuz...';

                    // Yetkiye göre yönlendirme (örneğin admin ise admin paneline)
                    if (data.user && data.user.isAdmin) {
                         setTimeout(() => { window.location.href = '/frontend/admin/users.html'; }, 1000);
                    } else {
                         setTimeout(() => { window.location.href = '/'; }, 1000); // Normal kullanıcı ana sayfa
                    }

                } else {
                    messageDiv.classList.remove('d-none');
                    messageDiv.classList.add('alert-danger');
                    messageDiv.textContent = data.message || 'Giriş başarısız.';
                }
            } catch (error) {
                console.error('Giriş hatası:', error);
                messageDiv.classList.remove('d-none');
                messageDiv.classList.add('alert-danger');
                messageDiv.textContent = 'Bir hata oluştu. Lütfen daha sonra tekrar deneyin.';
            }
        });

         // Sayfa yüklendiğinde sepet sayısını güncelle (Navbar için)
         document.addEventListener('DOMContentLoaded', () => {
             updateCartCount(); // script.js'ten
             updateUserMenu(); // script.js'ten
         });

    </script>
</body>
</html> 